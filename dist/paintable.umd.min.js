(function(t,e){"object"===typeof exports&&"object"===typeof module?module.exports=e():"function"===typeof define&&define.amd?define([],e):"object"===typeof exports?exports["paintable"]=e():t["paintable"]=e()})("undefined"!==typeof self?self:this,(function(){return function(t){var e={};function i(n){if(e[n])return e[n].exports;var s=e[n]={i:n,l:!1,exports:{}};return t[n].call(s.exports,s,s.exports,i),s.l=!0,s.exports}return i.m=t,i.c=e,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},i.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var s in t)i.d(n,s,function(e){return t[e]}.bind(null,s));return n},i.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s="fb15")}({"24fb":function(t,e,i){"use strict";function n(t,e){var i=t[1]||"",n=t[3];if(!n)return i;if(e&&"function"===typeof btoa){var r=s(n),a=n.sources.map((function(t){return"/*# sourceURL=".concat(n.sourceRoot||"").concat(t," */")}));return[i].concat(a).concat([r]).join("\n")}return[i].join("\n")}function s(t){var e=btoa(unescape(encodeURIComponent(JSON.stringify(t)))),i="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(e);return"/*# ".concat(i," */")}t.exports=function(t){var e=[];return e.toString=function(){return this.map((function(e){var i=n(e,t);return e[2]?"@media ".concat(e[2]," {").concat(i,"}"):i})).join("")},e.i=function(t,i,n){"string"===typeof t&&(t=[[null,t,""]]);var s={};if(n)for(var r=0;r<this.length;r++){var a=this[r][0];null!=a&&(s[a]=!0)}for(var o=0;o<t.length;o++){var c=[].concat(t[o]);n&&s[c[0]]||(i&&(c[2]?c[2]="".concat(i," and ").concat(c[2]):c[2]=i),e.push(c))}},e}},4226:function(t,e,i){"use strict";i("4839")},4839:function(t,e,i){var n=i("4979");"string"===typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);var s=i("499e").default;s("3368f113",n,!0,{sourceMap:!1,shadowMode:!1})},4979:function(t,e,i){var n=i("24fb");e=n(!1),e.push([t.i,".paintable,body{position:fixed}.paintable{overflow:hidden;height:100%;width:100%;-webkit-transform:scale(1);transform:scale(1)}.paintable.active{z-index:0}.paintable .canvas{position:relative;background-color:transparent;z-index:-1;position:absolute;left:0;top:0;overflow:hidden;-ms-touch-action:none;touch-action:none}.paintable .canvas.active{z-index:1000}.paintable .canvas.active.back{z-index:999}",""]),t.exports=e},"499e":function(t,e,i){"use strict";function n(t,e){for(var i=[],n={},s=0;s<e.length;s++){var r=e[s],a=r[0],o=r[1],c=r[2],h=r[3],d={id:t+":"+s,css:o,media:c,sourceMap:h};n[a]?n[a].parts.push(d):i.push(n[a]={id:a,parts:[d]})}return i}i.r(e),i.d(e,"default",(function(){return v}));var s="undefined"!==typeof document;if("undefined"!==typeof DEBUG&&DEBUG&&!s)throw new Error("vue-style-loader cannot be used in a non-browser environment. Use { target: 'node' } in your Webpack config to indicate a server-rendering environment.");var r={},a=s&&(document.head||document.getElementsByTagName("head")[0]),o=null,c=0,h=!1,d=function(){},l=null,u="data-vue-ssr-id",p="undefined"!==typeof navigator&&/msie [6-9]\b/.test(navigator.userAgent.toLowerCase());function v(t,e,i,s){h=i,l=s||{};var a=n(t,e);return f(a),function(e){for(var i=[],s=0;s<a.length;s++){var o=a[s],c=r[o.id];c.refs--,i.push(c)}e?(a=n(t,e),f(a)):a=[];for(s=0;s<i.length;s++){c=i[s];if(0===c.refs){for(var h=0;h<c.parts.length;h++)c.parts[h]();delete r[c.id]}}}}function f(t){for(var e=0;e<t.length;e++){var i=t[e],n=r[i.id];if(n){n.refs++;for(var s=0;s<n.parts.length;s++)n.parts[s](i.parts[s]);for(;s<i.parts.length;s++)n.parts.push(g(i.parts[s]));n.parts.length>i.parts.length&&(n.parts.length=i.parts.length)}else{var a=[];for(s=0;s<i.parts.length;s++)a.push(g(i.parts[s]));r[i.id]={id:i.id,refs:1,parts:a}}}}function m(){var t=document.createElement("style");return t.type="text/css",a.appendChild(t),t}function g(t){var e,i,n=document.querySelector("style["+u+'~="'+t.id+'"]');if(n){if(h)return d;n.parentNode.removeChild(n)}if(p){var s=c++;n=o||(o=m()),e=C.bind(null,n,s,!1),i=C.bind(null,n,s,!0)}else n=m(),e=w.bind(null,n),i=function(){n.parentNode.removeChild(n)};return e(t),function(n){if(n){if(n.css===t.css&&n.media===t.media&&n.sourceMap===t.sourceMap)return;e(t=n)}else i()}}var y=function(){var t=[];return function(e,i){return t[e]=i,t.filter(Boolean).join("\n")}}();function C(t,e,i,n){var s=i?"":n.css;if(t.styleSheet)t.styleSheet.cssText=y(e,s);else{var r=document.createTextNode(s),a=t.childNodes;a[e]&&t.removeChild(a[e]),a.length?t.insertBefore(r,a[e]):t.appendChild(r)}}function w(t,e){var i=e.css,n=e.media,s=e.sourceMap;if(n&&t.setAttribute("media",n),l.ssrId&&t.setAttribute(u,e.id),s&&(i+="\n/*# sourceURL="+s.sources[0]+" */",i+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(s))))+" */"),t.styleSheet)t.styleSheet.cssText=i;else{while(t.firstChild)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(i))}}},8875:function(t,e,i){var n,s,r;(function(i,a){s=[],n=a,r="function"===typeof n?n.apply(e,s):n,void 0===r||(t.exports=r)})("undefined"!==typeof self&&self,(function(){function t(){var e=Object.getOwnPropertyDescriptor(document,"currentScript");if(!e&&"currentScript"in document&&document.currentScript)return document.currentScript;if(e&&e.get!==t&&document.currentScript)return document.currentScript;try{throw new Error}catch(p){var i,n,s,r=/.*at [^(]*\((.*):(.+):(.+)\)$/gi,a=/@([^@]*):(\d+):(\d+)\s*$/gi,o=r.exec(p.stack)||a.exec(p.stack),c=o&&o[1]||!1,h=o&&o[2]||!1,d=document.location.href.replace(document.location.hash,""),l=document.getElementsByTagName("script");c===d&&(i=document.documentElement.outerHTML,n=new RegExp("(?:[^\\n]+?\\n){0,"+(h-2)+"}[^<]*<script>([\\d\\D]*?)<\\/script>[\\d\\D]*","i"),s=i.replace(n,"$1").trim());for(var u=0;u<l.length;u++){if("interactive"===l[u].readyState)return l[u];if(l[u].src===c)return l[u];if(c===d&&l[u].innerHTML&&l[u].innerHTML.trim()===s)return l[u]}return null}}return t}))},fb15:function(t,e,i){"use strict";if(i.r(e),"undefined"!==typeof window){var n=window.document.currentScript,s=i("8875");n=s(),"currentScript"in document||Object.defineProperty(document,"currentScript",{get:s});var r=n&&n.src.match(/(.+\/)[^/]+\.js(\?.*)?$/);r&&(i.p=r[1])}var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return t.hide?i("div",{staticClass:"content"},[t._t("default")],2):i("div",{staticClass:"paintable"},[i("canvas",{ref:"canvas-"+t.canvasId,staticClass:"canvas back",class:{active:t.isActive||t.alwaysOnTop},style:{pointerEvents:t.isActive?"all":"none",display:!t.canvasIsEmpty||t.isActive?"block":"none"},attrs:{width:t.width,height:t.height}}),i("canvas",{ref:"temp-canvas-"+t.canvasId,staticClass:"canvas",class:{active:t.isActive||t.alwaysOnTop},style:{pointerEvents:t.isActive?"all":"none",display:!t.canvasIsEmpty||t.isActive?"block":"none"},attrs:{width:t.width,height:t.height},on:t._d({},[t.drawMoveEvent,t.drawMove,t.drawStartEvent,t.drawStart,t.drawEndEvent,t.drawEnd])}),i("div",{staticClass:"content"},[t._t("default")],2)])},o=[];let c=0,h=0;var d={name:"paintable",props:{factor:{type:Number,default:1},navigation:{type:Object,default:null},alwaysOnTop:{type:Boolean,default:!0},name:{type:String,required:!0},width:{type:Number,default:window.innerWidth},height:{type:Number,default:window.innerHeight},hide:{type:Boolean,default:!1},threshold:{type:Number,default:0},showUndoRedo:{type:Boolean,default:!0},showLineWidth:{type:Boolean,default:!0},lineWidth:{type:Number,default:5},lineWidthEraser:{type:Number,default:20},colors:{type:Array,default:()=>["black","#f00","#4481c7","rgba(255, 235, 59, 0.4)","#999","green"]},horizontalNavigation:{type:Boolean,default:!1},active:{type:Boolean,default:!1},color:{type:String,default:"#000"},useEraser:{type:Boolean,default:!1}},data(){return{currentColor:this.color,canvasIsEmpty:!1,canvasId:0,isEraserActive:this.useEraser,isActive:this.active,pointCoords:[],redoList:[],undoList:[],currentLineWidth:this.isEraserActive?this.lineWidthEraser:this.lineWidth,tempCanvas:null,tempCtx:null,canvas:null,ctx:null,startedDrawing:!1,drawMoveEvent:"mousemove",drawStartEvent:"mousedown",drawEndEvent:"mouseup",isMouse:!0,thresholdReached:!1}},watch:{isActive:"init",name:"init",hide(){this.$nextTick(()=>{this.init()})},lineWidth(t){this.currentLineWidth=t},lineWidthEraser(t){this.currentLineWidth=t},useEraser(t){this.isEraserActive=t},active(t){this.isActive=t},color(t){this.currentColor=t,this.tempCtx.strokeStyle=this.currentColor,this.ctx.strokeStyle=this.currentColor},isEraserActive(t){this.currentLineWidth=t?this.lineWidthEraser:this.lineWidth},currentLineWidth(t){this.ctx.lineWidth=t,this.tempCtx.lineWidth=t}},beforeMount(){this.canvasId=Math.round(1e3*Math.random())},created(){this.isTouch&&(this.drawMoveEvent="touchmove",this.drawStartEvent="touchstart",this.drawEndEvent="touchend",this.isMouse=!1)},mounted(){this.init()},computed:{scalingFactor(){return window.devicePixelRatio||1},isTouch(){return"ontouchstart"in window||navigator.MaxTouchPoints>0||navigator.msMaxTouchPoints>0}},methods:{cancelDrawing(){this.loadImageFromStorage(),this.isActive=!1,this.isColorPickerOpen=!1,this.isLineWidthPickerOpen=!1},setItem(t,e){localStorage.setItem(t,e)},async getItem(t){return localStorage.getItem(t)},removeItem(t){localStorage.removeItem(t)},init(){try{this.pointCoords=[],this.tempCanvas=this.$refs["temp-canvas-"+this.canvasId],this.tempCtx=this.tempCanvas.getContext("2d"),this.canvas=this.$refs["canvas-"+this.canvasId],this.ctx=this.canvas.getContext("2d"),this.tempCtx.lineCap="round",this.ctx.lineCap="round",this.tempCtx.lineWidth=this.lineWidth,this.ctx.lineWidth=this.lineWidth,this.tempCtx.strokeStyle=this.currentColor,this.ctx.strokeStyle=this.currentColor,this.setItem(this.name+"-settings",JSON.stringify({width:this.canvas.width,height:this.canvas.height})),this.loadImageFromStorage(),this.$emit("toggle-paintable",this.isActive)}catch(t){}},undoDrawingStep(){this.restoreCanvasState(this.undoList,this.redoList)},redoDrawingStep(){this.restoreCanvasState(this.redoList,this.undoList)},restoreCanvasState(t,e){if(this.ctx.globalCompositeOperation="source-over",t.length){const i=t.pop();this.saveCurrentCanvasState(this.canvas,e,!0),this.loadImageFromStorage(i)}},saveCurrentCanvasState(t,e,i){i=i||!1,i||(this.redoList=[]),(e||this.undoList).push(t.toDataURL("image/png"))},async loadImageFromStorage(t){this.clearCanvas();const e=t||await this.getItem(this.name);if(e){const t=new Image;t.onload=()=>{this.ctx.drawImage(t,0,0),this.canvasIsEmpty=this.isCanvasBlank()},t.src=e}else this.canvasIsEmpty=this.isCanvasBlank()},clearCanvas(){this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height)},isCanvasBlank(){this.ctx.globalCompositeOperation="source-over";const t=document.createElement("canvas"),e=t.getContext("2d");return e.clearRect(0,0,this.canvas.width,this.canvas.height),t.width=this.canvas.width,t.height=this.canvas.height,t.toDataURL()===this.canvas.toDataURL()},saveCurrentCanvasToStorage(){this.isEraserActive=!1,this.isCanvasBlank()?(this.removeItem(this.name),this.removeItem(this.name+"-settings")):(this.setItem(this.name,this.canvas.toDataURL("image/png")),this.setItem(this.name+"-settings",JSON.stringify({width:this.canvas.width,height:this.canvas.height}))),this.undoList=[],this.redoList=[],this.canvasIsEmpty=this.isCanvasBlank()},drawStart(t){if(t.preventDefault(),this.thresholdReached=!1,this.isActive){this.isLineWidthPickerOpen=!1,this.isColorPickerOpen=!1,this.startedDrawing=!0,this.saveCurrentCanvasState(this.canvas);const e=this.isMouse?t.clientX:t.targetTouches[0].clientX,i=this.isMouse?t.clientY:t.targetTouches[0].clientY;e&&i&&(c=(e-this.tempCanvas.getBoundingClientRect().left)*this.factor,h=(i-this.tempCanvas.getBoundingClientRect().top)*this.factor,this.pointCoords.push({x:c,y:h})),this.tempCtx.globalCompositeOperation="source-over",this.ctx.globalCompositeOperation=this.isEraserActive?"destination-out":"source-over"}},drawEnd(){this.isActive&&(this.drawLine(this.ctx),this.startedDrawing=!1,this.pointCoords=[],this.thresholdReached=!1)},drawLine(t,e=!1){const i=this.pointCoords.filter((t,i)=>i%(e?10:25)===0);this.tempCtx.clearRect(0,0,this.canvas.width,this.canvas.height),t.beginPath(),t.moveTo(i[0].x,i[0].y);for(let n=0;n<i.length-1;n++){const e=n>0?i[n-1]:i[0],s=i[n],r=i[n+1],a=n!=i.length-2?i[n+2]:r,o=s.x+(r.x-e.x)/6,c=s.y+(r.y-e.y)/6,h=r.x-(a.x-s.x)/6,d=r.y-(a.y-s.y)/6;t.bezierCurveTo(o,c,h,d,r.x,r.y)}t.stroke()},drawMove(t){if(t.preventDefault(),this.isActive&&this.startedDrawing){const e=this.isMouse?t.clientX:t.targetTouches[0].clientX,i=this.isMouse?t.clientY:t.targetTouches[0].clientY;if(e&&i){if(c=(e-this.tempCanvas.getBoundingClientRect().left)*this.factor,h=(i-this.tempCanvas.getBoundingClientRect().top)*this.factor,this.pointCoords.push({x:c,y:h}),this.threshold){const t=Math.sqrt(Math.pow(this.pointCoords[this.pointCoords.length-1].y-this.pointCoords[0].y,2)+Math.pow(this.pointCoords[this.pointCoords.length-1].x-this.pointCoords[0].x,2));t>this.threshold&&(this.thresholdReached||(this.thresholdReached=!0,this.$emit("threshold-reached")))}this.drawLine(this.isEraserActive?this.ctx:this.tempCtx,!0)}}}}},l=d;i("4226");function u(t,e,i,n,s,r,a,o){var c,h="function"===typeof t?t.options:t;if(e&&(h.render=e,h.staticRenderFns=i,h._compiled=!0),n&&(h.functional=!0),r&&(h._scopeId="data-v-"+r),a?(c=function(t){t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,t||"undefined"===typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),s&&s.call(this,t),t&&t._registeredComponents&&t._registeredComponents.add(a)},h._ssrRegister=c):s&&(c=o?function(){s.call(this,(h.functional?this.parent:this).$root.$options.shadowRoot)}:s),c)if(h.functional){h._injectStyles=c;var d=h.render;h.render=function(t,e){return c.call(e),d(t,e)}}else{var l=h.beforeCreate;h.beforeCreate=l?[].concat(l,c):[c]}return{exports:t,options:h}}var p=u(l,a,o,!1,null,null,null),v=p.exports;const f={install(t,e){e&&e.setItem&&(v.methods.setItem=e.setItem),e&&e.getItem&&(v.methods.getItem=e.getItem),e&&e.removeItem&&(v.methods.removeItem=e.removeItem),t.component("paintable",v)}};var m=f;e["default"]=m}})}));